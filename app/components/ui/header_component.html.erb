<header class="bg-primary">
  <div class="flex justify-between h-[60px] max-w-content mx-auto px-layout">
    <div
      class="
        logo text-btn-primary flex h-full items-center
        font-['Yomogi',cursive] text-[1.2rem]
      "
    >
      <%= link_to "奥日曜のWebサイト", root_path, class: "text-btn-primary no-underline" %>
    </div>

    <div class="flex gap-2 relative">
      <button
        id="theme-toggle-button"
        data-controller="theme-toggle"
        data-action="click->theme-toggle#toggle"
        class="
          h-full border-none box-border flex items-center justify-center
          cursor-pointer bg-transparent
        "
      >
        <%# ライトモード時のアイコン: 月 %>
        <svg
          class="
            w-[30px] h-[30px] stroke-btn-primary transition-opacity
            duration-200 ease-in-out moon-icon
          "
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>

        <%# ダークモード時のアイコン: 太陽 %>
        <svg
          class="
            w-[30px] h-[30px] stroke-btn-primary transition-opacity
            duration-200 ease-in-out sun-icon
          "
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <circle cx="12" cy="12" r="5"></circle>

          <line
            x1="12"
            y1="1"
            x2="12"
            y2="3"
          ></line>

          <line
            x1="12"
            y1="21"
            x2="12"
            y2="23"
          ></line>

          <line
            x1="4.22"
            y1="4.22"
            x2="5.64"
            y2="5.64"
          ></line>

          <line
            x1="18.36"
            y1="18.36"
            x2="19.78"
            y2="19.78"
          ></line>

          <line
            x1="1"
            y1="12"
            x2="3"
            y2="12"
          ></line>

          <line
            x1="21"
            y1="12"
            x2="23"
            y2="12"
          ></line>

          <line
            x1="4.22"
            y1="19.78"
            x2="5.64"
            y2="18.36"
          ></line>

          <line
            x1="18.36"
            y1="5.64"
            x2="19.78"
            y2="4.22"
          ></line>
        </svg>

        <%# 初期表示の時にアイコンを設定する。Stimulusのconnect()だと一瞬誤ったボタンが表示されてしまうため、scriptタグで実行 %>
        <script>
          (function() {
            const theme = localStorage.getItem('theme') || 'light';
            const button = document.currentScript.parentElement;
            const moonIcon = button.querySelector('.moon-icon');
            const sunIcon = button.querySelector('.sun-icon');

            if (theme === 'dark') {
              moonIcon.style.display = 'none';
              sunIcon.style.display = 'block';
            } else {
              moonIcon.style.display = 'block';
              sunIcon.style.display = 'none';
            }
          })();
        </script>
      </button>

      <button
        class="
          hamburger-menu-button relative h-full border-none w-[60px]
          cursor-pointer flex flex-col items-center justify-center gap-1.5
        "
        data-controller="hamburger-menu"
        data-action="click->hamburger-menu#toggle"
      >
        <span
          class="
            hamburger-line w-6 h-[3px] bg-text-btn-primary transition-all
            duration-300 ease-in-out
          "
        ></span>

        <span
          class="
            hamburger-line w-6 h-[3px] bg-text-btn-primary transition-all
            duration-300 ease-in-out
          "
        ></span>

        <span
          class="
            hamburger-line w-6 h-[3px] bg-text-btn-primary transition-all
            duration-300 ease-in-out
          "
        ></span>
      </button>

      <nav
        class="
          hamburger-menu absolute top-[60px] right-0 bg-surface border
          border-default rounded-md min-w-[180px] z-[1000] hidden
          [&>a]:block [&>a]:py-3 [&>a]:px-4
          [&>a]:text-[var(--color-text-default)] [&>a]:no-underline
          [&>a]:text-size-body [&>a]:border-b [&>a]:border-default
          [&>a]:transition-colors [&>a]:duration-200 [&>a]:ease-in-out
          [&>a:first-child]:rounded-t-md [&>a:last-child]:border-b-0
          [&>a:last-child]:rounded-b-md [&>a:hover]:bg-bg-surface-hover
        "
      >
        <% if @login_user.present? %>
          <%= link_to "アカウント設定", users_account_settings_path %>
          <% if @login_user.author? %>
            <%= link_to "下書き一覧", users_post_drafts_path %>
            <%= link_to "公開記事一覧", user_posts_path(@login_user) %>
          <% end %>
          <%= link_to "ログアウト", logout_path, data: { "turbo-method": :delete } %>
        <% else %>
          <%= link_to "ログイン", login_path %>
          <%= link_to "サインアップ", new_users_database_authentication_path %>
        <% end %>
      </nav>
    </div>
  </div>
</header>
